<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, viewport-fit=cover"
  />
  <title>CaFES Check ‚Äì Identificaci√≥n de concesionario</title>

  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app-container">
    <section class="screen identification-screen">
      <header class="screen-header">
        <button class="back-button" onclick="location.href='index.html'">‚Üê</button>
        <span class="screen-title">Identificaci√≥n de concesionario</span>
      </header>

      <p class="identificacion-intro">
        Antes de levantar un reporte necesitamos identificar el concesionario
        y registrar evidencia del lugar en este momento.
      </p>

      <div class="identification-layout">

        <!-- PASO 1: FOTO -->
        <div class="ident-card" data-step="1">
          <h2 class="form-title">1. Toma una fotograf√≠a</h2>
          <p class="ident-text">
            Usa la c√°mara de tu dispositivo para capturar una imagen del √°rea
            o del problema. No se permite seleccionar im√°genes de la galer√≠a.
          </p>

          <div class="camera-box">
            <video
              id="camera-preview"
              autoplay
              playsinline
              class="camera-preview">
            </video>
            <canvas id="photo-canvas" class="hidden"></canvas>
            <img
              id="photo-preview"
              class="photo-preview hidden"
              alt="Vista previa de la fotograf√≠a" />
          </div>

          <div class="camera-buttons">
            <button id="btn-start-camera" class="btn btn-secondary">
              Activar c√°mara
            </button>
            <button id="btn-take-photo" class="btn btn-primary hidden">
              Tomar fotograf√≠a
            </button>
            <button id="btn-retake-photo" class="btn btn-secondary hidden">
              Volver a tomar
            </button>
          </div>
        </div>

        <!-- PASO 2: QR -->
        <div class="ident-card" data-step="2">
          <h2 class="form-title">2. Escanea el QR del concesionario</h2>
          <p class="ident-text">
            Acerca el c√≥digo QR del concesionario (pegado en la cafeter√≠a).
            Al escanearlo, llenaremos autom√°ticamente los datos.
          </p>

          <div class="camera-buttons">
            <button id="btn-start-qr" class="btn btn-secondary full-width">
              Activar esc√°ner QR
            </button>
          </div>

          <div id="qr-reader" class="qr-box"></div>

          <!-- üîπ TEXTO QUE SE VE ANTES DE ESCANEAR -->
          <p id="qr-hint" class="ident-text" style="margin-top: 10px; opacity: 0.8;">
            Escanea el QR para ver los datos del concesionario.
          </p>

          <!-- üîπ FORMULARIO OCULTO HASTA QUE EL QR SEA V√ÅLIDO -->
          <div id="concesionario-datos" class="signup-form concesionario-form hidden">

            <div class="form-group">
              <label for="campo-num-aut">N√∫mero autorizado</label>
              <input type="text" id="campo-num-aut" readonly />
            </div>

            <div class="form-group">
              <label for="campo-dependencia">Dependencia</label>
              <input type="text" id="campo-dependencia" readonly />
            </div>

            <div class="form-group">
              <label for="campo-localidad">Localidad</label>
              <input type="text" id="campo-localidad" readonly />
            </div>

            <div class="form-group">
              <label for="campo-autorizado">Autorizado</label>
              <input type="text" id="campo-autorizado" readonly />
            </div>

            <div class="form-group">
              <label for="campo-horario">Horario</label>
              <input type="text" id="campo-horario" readonly />
            </div>

          </div>
        </div>
      </div>

      <div class="ident-footer">
        <button id="btn-continuar" class="btn btn-primary full-width" disabled>
          Continuar a pantalla principal
        </button>
      </div>
    </section>
  </div>

  <!-- Scripts al final -->
  <script src="https://unpkg.com/html5-qrcode"></script>
  <script src="identification.js"></script>
</body>
</html>
